@prefix math: <http://www.w3.org/2000/10/swap/math#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#> .
@prefix e: <http://eulersharp.sourceforge.net/2003/03swap/log-rules#> .
@prefix diff: <http://www.w3.org/2004/delta#>.
@prefix : <http://semex.sigmanoise.com/r3/life-sim#> .


:必然事件 :super-class :事件.
{?x a :必然事件} => {?x :概率 :必然}.
{?x :概率 :必然} => {?x a :必然事件}.

# 概率分为 :不可能（0%）、:罕见（5）、:少见（20）、:有时（50）、:常见(80)、:必然（100）. 默认是有时

{?x a :事件. ?scope e:fail {?x :概率 ?y}} => {?x :概率 :有时}.

:丰收
    a :事件;
    :描述 "今年大丰收，而且你家的菜也涨价了";
    :前提 {:self :住在农村 true };
    :后果增量 {:self :家境 1};
    :概率   :有时;
.

:欠收
    a :事件;
    :描述 "今年发生了旱灾/洪水，你家颗粒无收";
    :前提 {:self :住在农村 true };
    :后果增量 {:self :家境 -1};
    :概率   :有时;
    :互斥事件 :丰收;
.


# :生成天赋 a :必然事件;
#     :描述   "生成一组天赋供玩家选择";
#     :参数   :天赋数量;
#     :前提   {:self  :可选天赋数 ?x. ?x math:greaterThan 0};
#     :后果  {
#         {} diff:replacement {}
#     }
# .



# 事件的后果可以是另一个事件？
:出生 a  :必然事件;
    :描述 "你出生了！";
    :前提 {:self :年龄 0}; 
    :后果替换 {:self :年龄 1};
    :后果分支  #后果分支是一个列表，其中的事件视为互补
        (
            [:后果替换 {:self :性别 :男}; :概率值 0.5 ]
            [:后果替换 {:self :性别 :女}; :概率值 0.5 ]
        )

.

# 这是必然事件
:过去1年 a :必然事件;
    :描述 "过去了1年";
    #:参数 :度过的年份;
    #:前提 {:self :年龄 ?x};
    :后果增量 {:self :年龄 1};
.


:得了肺炎 
    a :事件;
    :父事件 :患病;
    :前提 {:self :体质 ?x. ?x math:lessThan 3 };
    :后果增量 {:self :体质 -2};
.

[
    a :事件;
    :描述 "刚学会走路，你意外从桌子上跌落";
    :前提 {:self :年龄 2};
    :后果增量 {:self :体质 -2};
].



#{?x a :事件. :self :年龄 ?y. ?y math:lessThan 10. :self :体质 ?z. ?z math:lessThan 0} => {?x a :小时候的致死事件}.

{
    ?x a :事件;
        :后果替换 {?s ?prop ?o}.
} => {
        ?x :后果 
        {
            {?s ?prop ?v } diff:replacement {?s ?prop ?o}
        }
}.

{
    ?x a :事件;
        :后果增量 {?s ?prop ?delta}.
    ?s ?prop ?v. 
    (?v ?delta) math:sum ?v2
} => {
        ?x :后果
        {
            {?s ?prop ?v } diff:replacement {?s ?prop ?v2}
        }
}.